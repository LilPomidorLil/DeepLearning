
























 96%|█████████▌| 24/25 [20:48<00:47, 47.92s/it]
Done
<xml><var name="Conv2NeuralNetwork" type="type" qualifier="builtins" value="%3Cclass %27__main__.Conv2NeuralNetwork%27&gt;" isContainer="True" />
<var name="ConvNeuralNetwork" type="type" qualifier="builtins" value="%3Cclass %27__main__.ConvNeuralNetwork%27&gt;" isContainer="True" />
<var name="Image" type="module" qualifier="builtins" value="%3Cmodule %27PIL.Image%27 from %27/home/shuffle/anaconda3/lib/python3.9/site-packages/PIL/Image.py%27&gt;" isContainer="True" />
<var name="In" type="list" qualifier="builtins" value="%5B%27%27%2C %27import warnings%5Cn%5Cnimport matplotlib.pyplot as plt%5Cnimport numpy as np%5Cnfrom matplotlib import cm%5Cnfrom tqdm import tqdm%5Cn%5Cnwarnings.filterwarnings%28%22ignore%22%29%27%2C %22get_ipython%28%29.system%28%27wget https%3A//raw.githubusercontent.com/hushchyn-mikhail/CourseraDL/main/cnn/screencast_1/butterfly.jpg%27%29%22%2C %27from PIL import Image%5Cn%5Cnimg = Image.open%28%22butterfly.jpg%22%29%5Cnprint%28f%22Image format%3A %7Bimg.format%7D%2C shape%7Bimg.size%7D%2C color scheme%3A %7Bimg.mode%7D%22%29%5Cnimg%27%2C %27img_matrix = np.array%28img%29%5Cn%5Cn%23 %28%D0%B2%D1%8B%D1%81%D0%BE%D1%82%D0%B0%2C %D1%88%D0%B8%D1%80%D0%B8%D0%BD%D0%B0%2C %D1%87%D0%B8%D1%81%D0%BB%D0%BE %D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%BE%D0%B2%29%5Cnprint%28f%22Image matrix shape%3A %7Bimg_matrix.shape%7D%22%29%5Cn%5Cn%23 427 %D1%81%D1%82%D1%80%D0%BE%D0%BA%2C %D0%BA%D0%B0%D0%B6%D0%B4%D0%B0%D1%8F %D1%81%D1%82%D1%80%D0%BE%D0%BA%D0%B0 %D1%81%D0%BE%D0%B4%D0%B5%D1%80%D0%B6%D0%B8%D1%82 640 %D1%81%D1%82%D0%BE%D0%BB%D0%B1%D1%86%D0%BE%D0%B2%2C %D0%BA%D0%B0%D0%B6%D0%B4%D1%8B%D0%B9 %D1%8D%D0%BB%D0%B5%D0%BC%D0%B5%D0%BD%D1%82 %D1%81%D1%82%D0%BE%D0%BB%D0%B1%D1%86%D0%B0 %D0%BE%D0%BF%D0%B8%D1%81%D1%8B%D0%B2%D0%B0%D0%B5%D1%82%D1%81%D1%8F 3 %D1%87%D0%B8%D1%81%D0%BB%D0%B0%D0%BC%D0%B8 - RGB%5Cn%23 img_matrix%5Cnplt.imshow%28img_matrix%29%5Cnplt.show%28%29%27%2C %27%23 %D0%BF%D0%BE%D1%81%D0%BC%D0%BE%D1%82%D1%80%D0%B8%D0%BC %D0%BD%D0%B0 %D0%B2%D1%81%D0%B5 %D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D1%8B %D0%BE%D1%82%D0%B4%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%5Cnplt.imshow%28img_matrix%5B%3A%2C %3A%2C 0%5D%2C cmap = cm.Reds%29%5Cnplt.show%28%29%5Cn%5Cnplt.imshow%28img_matrix%5B%3A%2C %3A%2C 1%5D%2C cmap = cm.Greens%29%5Cnplt.show%28%29%5Cn%5Cnplt.imshow%28img_matrix%5B%3A%2C %3A%2C 2%5D%2C cmap = cm.Blues%29%5Cnplt.show%28%29%27%2C %27import torch%5Cnfrom torch.nn.functional import conv2d%27%2C %27..." isContainer="True" shape="31" isIPythonHidden="True" />
<var name="NeuralNetwork" type="type" qualifier="builtins" value="%3Cclass %27__main__.NeuralNetwork%27&gt;" isContainer="True" />
<var name="Out" type="dict" qualifier="builtins" value="%7B3%3A %3CPIL.JpegImagePlugin.JpegImageFile image mode=RGB size=640x427 at 0x7F863252B0D0&gt;%2C 7%3A torch.Size%28%5B1%2C 427%2C 640%2C 3%5D%29%2C 8%3A torch.Size%28%5B1%2C 3%2C 427%2C 640%5D%29%2C 9%3A torch.Size%28%5B1%2C 3%2C 3%2C 3%5D%29%2C 10%3A torch.Size%28%5B1%2C 425%2C 638%2C 1%5D%29%2C 12%3A torch.Size%28%5B1%2C 3%2C 3%2C 3%5D%29%2C 13%3A torch.Size%28%5B1%2C 425%2C 638%2C 1%5D%29%2C 22%3A %3Cwandb.sdk.wandb_run.Run object at 0x7f852445cb20&gt;%7D" isContainer="True" shape="8" isIPythonHidden="True" />
<var name="_" type="Run" qualifier="wandb.sdk.wandb_run" value="%3Cwandb.sdk.wandb_run.Run object at 0x7f852445cb20&gt;" isContainer="True" isIPythonHidden="True" />
<var name="_10" type="Size" qualifier="torch" value="torch.Size%28%5B1%2C 425%2C 638%2C 1%5D%29" isContainer="True" shape="4" isIPythonHidden="True" />
<var name="_12" type="Size" qualifier="torch" value="torch.Size%28%5B1%2C 3%2C 3%2C 3%5D%29" isContainer="True" shape="4" isIPythonHidden="True" />
<var name="_13" type="Size" qualifier="torch" value="torch.Size%28%5B1%2C 425%2C 638%2C 1%5D%29" isContainer="True" shape="4" isIPythonHidden="True" />
<var name="_22" type="Run" qualifier="wandb.sdk.wandb_run" value="%3Cwandb.sdk.wandb_run.Run object at 0x7f852445cb20&gt;" isContainer="True" isIPythonHidden="True" />
<var name="_3" type="JpegImageFile" qualifier="PIL.JpegImagePlugin" value="%3CPIL.JpegImagePlugin.JpegImageFile image mode=RGB size=640x427 at 0x7F863252B0D0&gt;" isContainer="True" isIPythonHidden="True" />
<var name="_7" type="Size" qualifier="torch" value="torch.Size%28%5B1%2C 427%2C 640%2C 3%5D%29" isContainer="True" shape="4" isIPythonHidden="True" />
<var name="_8" type="Size" qualifier="torch" value="torch.Size%28%5B1%2C 3%2C 427%2C 640%5D%29" isContainer="True" shape="4" isIPythonHidden="True" />
<var name="_9" type="Size" qualifier="torch" value="torch.Size%28%5B1%2C 3%2C 3%2C 3%5D%29" isContainer="True" shape="4" isIPythonHidden="True" />
<var name="__" type="Size" qualifier="torch" value="torch.Size%28%5B1%2C 425%2C 638%2C 1%5D%29" isContainer="True" shape="4" isIPythonHidden="True" />
<var name="___" type="Size" qualifier="torch" value="torch.Size%28%5B1%2C 3%2C 3%2C 3%5D%29" isContainer="True" shape="4" isIPythonHidden="True" />
<var name="__builtin__" type="module" qualifier="builtins" value="%3Cmodule %27builtins%27 %28built-in%29&gt;" isContainer="True" isIPythonHidden="True" />
<var name="__builtins__" type="module" qualifier="builtins" value="%3Cmodule %27builtins%27 %28built-in%29&gt;" isContainer="True" isIPythonHidden="True" />
<var name="__doc__" type="str" qualifier="builtins" value="Automatically created module for IPython interactive environment" isIPythonHidden="True" />
<var name="__loader__" type="NoneType" qualifier="builtins" value="None" isIPythonHidden="True" />
<var name="__name__" type="str" qualifier="builtins" value="__main__" isIPythonHidden="True" />
<var name="__package__" type="NoneType" qualifier="builtins" value="None" isIPythonHidden="True" />
<var name="__spec__" type="NoneType" qualifier="builtins" value="None" isIPythonHidden="True" />
<var name="_dh" type="list" qualifier="builtins" value="%5BPosixPath%28%27/home/shuffle/DL-IAD-HSE/DeepLearning/%D0%9C%D0%B5%D1%82%D0%BE%D0%B4 %D0%BE%D0%B1%D1%80%D0%B0%D1%82%D0%BD%D0%BE%D0%B3%D0%BE %D1%80%D0%B0%D1%81%D0%BF%D1%80%D0%BE%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B5%D0%BD%D0%B8%D1%8F %D0%BE%D1%88%D0%B8%D0%B1%D0%BA%D0%B8. %D0%A1%D0%B2%D1%91%D1%80%D1%82%D0%BA%D0%B8 %D0%B8 %D1%81%D0%B2%D1%91%D1%80%D1%82%D0%BE%D1%87%D0%BD%D1%8B%D0%B5 %D1%81%D0%BB%D0%BE%D0%B8/Seminar%27%29%5D" isContainer="True" shape="1" isIPythonHidden="True" />
<var name="_exit_code" type="int" qualifier="builtins" value="0" />
<var name="_i" type="str" qualifier="builtins" value="class Conv2NeuralNetwork%28nn.Module%29%3A%0A    def __init__%28self%29%3A%0A        super%28Conv2NeuralNetwork%2C self%29.__init__%28%29%0A        self.conv_pooling_linear_relu_stack = nn.Sequential%28%0A            nn.Conv2d%28in_channels=1%2C out_channels=10%2C kernel_size=5%29%2C%0A            nn.ReLU%28%29%2C%0A            nn.MaxPool2d%28kernel_size=2%29%2C%0A            nn.Conv2d%28in_channels=10%2C out_channels=20%2C kernel_size=5%29%2C%0A            nn.ReLU%28%29%2C%0A            nn.MaxPool2d%28kernel_size=2%29%2C%0A            nn.Flatten%28%29%2C%0A            nn.Linear%284%2A4%2A20%2C 128%29%2C%0A            nn.ReLU%28%29%2C%0A            nn.Linear%28128%2C 10%29%0A        %29%0A    def forward%28self%2C x%29%3A%0A        logits = self.conv_pooling_linear_relu_stack%28x%29%0A        return logits%0A    %0Amodel_conv2 = Conv2NeuralNetwork%28%29.to%28device%29%0Aprint%28model_conv2%29" isIPythonHidden="True" />
<var name="_i1" type="str" qualifier="builtins" value="import warnings%0A%0Aimport matplotlib.pyplot as plt%0Aimport numpy as np%0Afrom matplotlib import cm%0Afrom tqdm import tqdm%0A%0Awarnings.filterwarnings%28%22ignore%22%29" isIPythonHidden="True" />
<var name="_i10" type="str" qualifier="builtins" value="%23 %D1%81%D0%B2%D0%B5%D1%80%D0%BD%D0%B5%D0%BC %D0%BA%D0%B0%D1%80%D1%82%D0%B8%D0%BD%D0%BA%D1%83 %D1%81 %D0%BF%D0%BE%D0%B4%D0%B3%D0%BE%D1%82%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%BD%D1%8B%D0%BC %D1%8F%D0%B4%D1%80%D0%BE%D0%BC %D1%81%D0%B2%D0%B5%D1%80%D1%82%D0%BA%D0%B8%0Aimg_conv_hor = conv2d%28img_tensor%2C kernel%29%0Aimg_conv_hor = torch.permute%28img_conv_hor%2C %280%2C 2%2C 3%2C 1%29%29%0A%0A%23 %D1%87%D0%B8%D1%81%D0%BB%D0%BE %D0%B8%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B9%2C %D0%B2%D1%8B%D1%81%D0%BE%D1%82%D0%B0%2C %D1%88%D0%B8%D1%80%D0%B8%D0%BD%D0%B0%2C %D1%87%D0%B8%D1%81%D0%BB%D0%BE %D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%BE%D0%B2%0Aimg_conv_hor.size%28%29" isIPythonHidden="True" />
<var name="_i11" type="str" qualifier="builtins" value="plt.figure%28figsize = %281.5 %2A 7%2C 1.5 %2A 4%29%29%0Aplt.imshow%28torch.abs%28img_conv_hor%5B0%2C %3A%2C %3A%2C 0%5D%29%29%0Aplt.show%28%29" isIPythonHidden="True" />
<var name="_i12" type="str" qualifier="builtins" value="sobel_ver = %5B%5B-1%2C  0%2C  1%5D%2C%0A             %5B-2%2C  0%2C  2%5D%2C%0A             %5B-1%2C  0%2C  1%5D%5D%0A%0A%23 %D0%BE%D0%B4%D0%BD%D0%B0 %D0%BC%D0%B0%D1%82%D1%80%D0%B8%D1%86%D0%B0 %D0%BD%D0%B0 %D0%BA%D0%B0%D0%B6%D0%B4%D1%8B%D0%B9 %D0%BA%D0%B0%D0%BD%D0%B0%D0%BB %D0%BA%D0%B0%D1%80%D1%82%D0%B8%D0%BD%D0%BA%D0%B8%0Akernel = %5B%5Bsobel_ver%2C sobel_ver%2C sobel_ver%5D%5D%0Akernel = torch.tensor%28kernel%2C dtype = torch.float%29%0A%0A%23 %28%D1%87%D0%B8%D1%81%D0%BB%D0%BE %D0%B2%D1%8B%D1%85%D0%BE%D0%B4%D0%BD%D1%8B%D1%85 %D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%BE%D0%B2%2C %D1%87%D0%B8%D1%81%D0%BB%D0%BE %D0%B2%D1%85%D0%BE%D0%B4%D0%BD%D1%8B%D1%85 %D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%BE%D0%B2%2C %D0%B2%D1%8B%D1%81%D0%BE%D1%82%D0%B0%2C %D1%88%D0%B8%D1%80%D0%B8%D0%BD%D0%B0%29%0Akernel.size%28%29" isIPythonHidden="True" />
<var name="_i13" type="str" qualifier="builtins" value="%23 %D1%81%D0%B2%D0%B5%D1%80%D0%BD%D0%B5%D0%BC %D0%BA%D0%B0%D1%80%D1%82%D0%B8%D0%BD%D0%BA%D1%83 %D1%81 %D0%BF%D0%BE%D0%B4%D0%B3%D0%BE%D1%82%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%BD%D1%8B%D0%BC %D1%8F%D0%B4%D1%80%D0%BE%D0%BC %D1%81%D0%B2%D0%B5%D1%80%D1%82%D0%BA%D0%B8%0Aimg_conv_ver = conv2d%28img_tensor%2C kernel%29%0Aimg_conv_ver = torch.permute%28img_conv_ver%2C %280%2C 2%2C 3%2C 1%29%29%0A%0A%23 %D1%87%D0%B8%D1%81%D0%BB%D0%BE %D0%B8%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B9%2C %D0%B2%D1%8B%D1%81%D0%BE%D1%82%D0%B0%2C %D1%88%D0%B8%D1%80%D0%B8%D0%BD%D0%B0%2C %D1%87%D0%B8%D1%81%D0%BB%D0%BE %D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%BE%D0%B2%0Aimg_conv_ver.size%28%29" isIPythonHidden="True" />
<var name="_i14" type="str" qualifier="builtins" value="plt.figure%28figsize = %281.5 %2A 7%2C 1.5 %2A 4%29%29%0Aplt.imshow%28torch.abs%28img_conv_ver%5B0%2C %3A%2C %3A%2C 0%5D%29%29%0Aplt.show%28%29" isIPythonHidden="True" />
<var name="_i15" type="str" qualifier="builtins" value="img_conv = torch.sqrt%28img_conv_hor%2A%2A2 %2B img_conv_ver%2A%2A2%29%0A%0A%23 %D0%BC%D0%BE%D0%B4%D1%83%D0%BB%D1%8C %D0%BD%D0%B5 %D0%BD%D1%83%D0%B6%D0%B5%D0%BD%2C %D0%BF%D0%BE%D1%82%D0%BE%D0%BC%D1%83 %D1%87%D1%82%D0%BE %D0%B8%D0%B7%D0%B2%D0%BB%D0%B5%D0%BA%D0%BB%D0%B8 %D0%BA%D0%BE%D1%80%D0%B5%D0%BD%D1%8C%0Aplt.figure%28figsize = %281.5 %2A 7%2C 1.5 %2A 4%29%29%0Aplt.imshow%28img_conv%5B0%2C %3A%2C %3A%2C 0%5D%29%0Aplt.show%28%29" isIPythonHidden="True" />
<var name="_i16" type="str" qualifier="builtins" value="kernel = torch.rand%281%2C 3%2C 3%2C 3%2C dtype = torch.float%29%0A%0A%23 %D1%81%D0%B2%D0%B5%D1%80%D1%82%D0%BA%D0%B0 %D0%B8%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D1%8F%0Aimg_conv_ver = conv2d%28img_tensor%2C kernel%29%0Aimg_conv_ver = img_conv_ver.permute%280%2C 2%2C 3%2C 1%29%0A%0A%23 %D1%80%D0%B8%D1%81%D1%83%D0%B5%D0%BC %D1%80%D0%B5%D0%B7%D1%83%D0%BB%D1%8C%D1%82%D0%B0%D1%82%0Aplt.figure%28figsize=%281.5 %2A 7%2C 1.5 %2A 4%29%29%0Aplt.imshow%28torch.abs%28img_conv_ver%5B0%2C %3A%2C %3A%2C 0%5D%29%29%0Aplt.show%28%29" isIPythonHidden="True" />
<var name="_i17" type="str" qualifier="builtins" value="import torchvision%0Afrom torch import nn" isIPythonHidden="True" />
<var name="_i18" type="str" qualifier="builtins" value="%23 %D0%BD%D0%B0%D0%BF%D0%B8%D1%88%D0%B5%D0%BC %D0%BA%D0%BE%D0%BD%D0%B2%D0%B5%D0%B9%D0%B5%D1%80 %D1%82%D1%80%D0%B0%D0%BD%D1%81%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D0%B8 %D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85%0A%0Atransform = torchvision.transforms.Compose%28%0A    %5B%0A        torchvision.transforms.ToTensor%28%29%2C%0A        torchvision.transforms.Normalize%28%280.1307%2C%29%2C %280.3081%2C%29%29%0A    %5D%0A%29%0A%0A%23 %D0%B7%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D0%B8%D0%BC %D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5%0Amnist_train = torchvision.datasets.MNIST%28%0A    root = %22./mnist-data/%22%2C%0A    train = True%2C%0A    download = True%2C%0A    transform=transform%0A%29%0A%0Amnist_val = torchvision.datasets.MNIST%28%0A    root = %22./mnist-data/%22%2C%0A    train = False%2C%0A    download = True%2C%0A    transform=transform%0A%29%0A%0Atrain_dataloader = torch.utils.data.DataLoader%28mnist_train%2C batch_size=64%2C shuffle=True%29%0Aval_dataloader = torch.utils.data.DataLoader%28mnist_val%2C batch_size=64%2C shuffle=True%29" isIPythonHidden="True" />
<var name="_i19" type="str" qualifier="builtins" value="for i in %5B0%2C 1%5D%3A%0A    plt.subplot%281%2C 2%2C i %2B 1%29%0A    plt.imshow%28mnist_train%5Bi%5D%5B0%5D.squeeze%280%29.numpy%28%29.reshape%28%5B28%2C 28%5D%29%29%0A    plt.title%28str%28mnist_train%5Bi%5D%5B1%5D%29%29%0Aplt.show%28%29" isIPythonHidden="True" />
<var name="_i2" type="str" qualifier="builtins" value="%21wget https%3A//raw.githubusercontent.com/hushchyn-mikhail/CourseraDL/main/cnn/screencast_1/butterfly.jpg" isIPythonHidden="True" />
<var name="_i20" type="str" qualifier="builtins" value="device = %22cuda%22 if torch.cuda.is_available%28%29 else %22cpu%22%0Aprint%28f%22Using %7Bdevice%7D device%22%29%0A%0Aclass NeuralNetwork%28nn.Module%29%3A%0A    def __init__%28self%29%3A%0A        super%28NeuralNetwork%2C self%29.__init__%28%29%0A        self.Flatten = nn.Flatten%28%29%0A        self.linear_relu_stack = nn.Sequential%28%0A            nn.Linear%2828 %2A 28%2C 128%29%2C%0A            nn.ReLU%28%29%2C%0A            nn.Linear%28128%2C 10%29%0A        %29%0A%0A    def forward%28self%2C x%29%3A%0A        x = self.Flatten%28x%29%0A        logits = self.linear_relu_stack%28x%29%0A        return logits%0A%0Amodel = NeuralNetwork%28%29.to%28device%29%0Aprint%28model%29" isIPythonHidden="True" />
<var name="_i21" type="str" qualifier="builtins" value="class ConvNeuralNetwork%28nn.Module%29%3A%0A    def __init__%28self%29%3A%0A        super%28ConvNeuralNetwork%2C self%29.__init__%28%29%0A        self.conv_linear_relu_stack = nn.Sequential%28%0A            nn.Conv2d%28in_channels=1%2C out_channels=10%2C kernel_size=5%29%2C                       %23 %D1%81%D0%B2%D0%B5%D1%80%D1%82%D0%BA%D0%B0 %D1%81 10 %D1%8F%D0%B4%D1%80%D0%B0%D0%BC%D0%B8 %D1%80%D0%B0%D0%B7%D0%BC%D0%B5%D1%80%D0%B0 5%0A            nn.ReLU%28%29%2C%0A            nn.MaxPool2d%28kernel_size=4%29%2C                                                    %23 %D1%83%D0%BC%D0%B5%D0%BD%D1%8C%D1%88%D0%B8%D0%B5 %D0%B8%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D1%8F %D0%B2 4 %D1%80%D0%B0%D0%B7%D0%B0 %D0%BF%D0%BE %D0%BA%D0%B0%D0%B6%D0%B4%D0%BE%D0%B9 %D1%81%D1%82%D0%BE%D1%80%D0%BE%D0%BD%D0%B5%0A            nn.Flatten%28%29%2C                                                                   %23 %D0%BF%D1%80%D0%B5%D0%B2%D1%80%D0%B0%D1%89%D0%B0%D0%B5%D0%BC %D0%BA%D0%B0%D1%80%D1%82%D0%B8%D0%BD%D0%BA%D1%83 6%D1%856%D1%8510 %D0%B2 %D0%B2%D0%B5%D0%BA%D1%82%D0%BE%D1%80 %D1%80%D0%B0%D0%B7%D0%BC%D0%B5%D1%80%D0%B0 360%0A            nn.Linear%286%2A6%2A10%2C 128%29%2C%0A            nn.ReLU%28%29%2C%0A            nn.Linear%28128%2C 10%29%0A        %29%0A%0A    def forward%28self%2C x%29%3A%0A        last_layer = self.conv_linear_relu_stack%28x%29%0A        return last_layer%0A%0Amodel_conv = ConvNeuralNetwork%28%29.to%28device%29%0Aprint%28model_conv%29" isIPythonHidden="True" />
<var name="_i22" type="str" qualifier="builtins" value="import wandb%0A%0Aconfig = dict %28%0A    learning_rate = 0.01%2C%0A    architecture = %22FCNN%22%2C%0A    dataset_id = %22MNIST%22%2C%0A%29%0A%0Awandb.init%28%0A    project=%22Sem-02%22%2C%0A    notes=%22tweak baseline%22%2C%0A    tags=%5B%22baseline%22%2C %22paper1%22%5D%2C%0A    config=config%2C%0A%29" isIPythonHidden="True" />
<var name="_i23" type="str" qualifier="builtins" value="def train%28dataloader%2C model%2C loss_fn%2C opt%29%3A%0A    size = len%28dataloader.dataset%29%0A    model.train%28%29%0A%0A    for batch%2C %28X%2C y%29 in enumerate%28dataloader%29%3A%0A        X%2C y = X.to%28device%29%2C y.to%28device%29%0A%0A        %23 forward%0A        pred = model%28X%29%0A        loss = loss_fn%28pred%2C y%29%0A%0A        %23 back%0A        opt.zero_grad%28%29%0A        loss.backward%28%29%0A        opt.step%28%29" isIPythonHidden="True" />
<var name="_i24" type="str" qualifier="builtins" value="def test%28dataloader%2C model%2C loss_fn%29%3A%0A    size = len%28dataloader.dataset%29%0A    num_batches = len%28dataloader%29%0A    model.eval%28%29%0A    test_loss%2C correct = 0%2C 0%0A    with torch.no_grad%28%29%3A%0A        for X%2C y in dataloader%3A%0A            X%2C y = X.to%28device%29%2C y.to%28device%29%0A            pred = model%28X%29%0A            test_loss %2B= loss_fn%28pred%2C y%29.item%28%29%0A            correct %2B= %28pred.argmax%281%29 == y%29.type%28torch.float%29.sum%28%29.item%28%29%0A    test_loss /= num_batches%0A    correct /= size%0A    wandb.log%28%7B%22mean val loss%22%3A test_loss%2C%0A               %22mean val accuracy%22%3A 100%2Acorrect%7D%29" isIPythonHidden="True" />
<var name="_i25" type="str" qualifier="builtins" value="loss = nn.CrossEntropyLoss%28%29%0Aoprimizer = torch.optim.SGD%28params=model.parameters%28%29%2C lr = 0.01%29%0A%0Aloss_conv = nn.CrossEntropyLoss%28%29%0Aoprimizer_conv = torch.optim.SGD%28params=model_conv.parameters%28%29%2C lr = 0.01%29" isIPythonHidden="True" />
<var name="_i26" type="str" qualifier="builtins" value="epochs = 25%0Awandb.watch%28model%29%0Afor t in tqdm%28range%28epochs%29%29%3A%0A    train%28train_dataloader%2C model%2C loss%2C oprimizer%29%0A    test%28val_dataloader%2C model%2C loss%29%0A%0Aprint%28%22Done%22%29" isIPythonHidden="True" />
<var name="_i27" type="str" qualifier="builtins" value="epochs = 25%0A%0Aconfig = dict %28%0A    learning_rate = 0.01%2C%0A    architecture = %22CNN%22%2C%0A    dataset_id = %22MNIST%22%2C%0A%29%0A%0Awandb.init%28%0A    project=%22Sem-02%22%2C%0A    notes=%22tweak baseline%22%2C%0A    tags=%5B%22baseline%22%5D%2C%0A    config=config%2C%0A%29%0A%0Awandb.watch%28model_conv%29%0A%0Afor t in tqdm%28range%28epochs%29%29%3A%0A    train%28train_dataloader%2C model_conv%2C loss_conv%2C oprimizer_conv%29%0A    test%28val_dataloader%2C model%2C loss_conv%29%0A%0Aprint%28%22Done%22%29" isIPythonHidden="True" />
<var name="_i28" type="str" qualifier="builtins" value="epochs = 25%0A%0Aconfig = dict %28%0A    learning_rate = 0.01%2C%0A    architecture = %22CNN%22%2C%0A    dataset_id = %22MNIST%22%2C%0A%29%0A%0Awandb.init%28%0A    project=%22Sem-02%22%2C%0A    notes=%22tweak baseline%22%2C%0A    tags=%5B%22baseline%22%5D%2C%0A    config=config%2C%0A%29%0A%0Awandb.watch%28model_conv%29%0A%0Afor t in tqdm%28range%28epochs%29%29%3A%0A    train%28train_dataloader%2C model_conv%2C loss_conv%2C oprimizer_conv%29%0A    test%28val_dataloader%2C model_conv%2C loss_conv%29%0A%0Aprint%28%22Done%22%29" isIPythonHidden="True" />
<var name="_i29" type="str" qualifier="builtins" value="class Conv2NeuralNetwork%28nn.Module%29%3A%0A    def __init__%28self%29%3A%0A        super%28Conv2NeuralNetwork%2C self%29.__init__%28%29%0A        self.conv_pooling_linear_relu_stack = nn.Sequential%28%0A            nn.Conv2d%28in_channels=1%2C out_channels=10%2C kernel_size=5%29%2C%0A            nn.ReLU%28%29%2C%0A            nn.MaxPool2d%28kernel_size=2%29%2C%0A            nn.Conv2d%28in_channels=10%2C out_channels=20%2C kernel_size=5%29%2C%0A            nn.ReLU%28%29%2C%0A            nn.MaxPool2d%28kernel_size=2%29%2C%0A            nn.Flatten%28%29%2C%0A            nn.Linear%284%2A4%2A20%2C 128%29%2C%0A            nn.ReLU%28%29%2C%0A            nn.Linear%28128%2C 10%29%0A        %29%0A    def forward%28self%2C x%29%3A%0A        logits = self.conv_pooling_linear_relu_stack%28x%29%0A        return logits%0A    %0Amodel_conv2 = Conv2NeuralNetwork%28%29.to%28device%29%0Aprint%28model_conv2%29" isIPythonHidden="True" />
<var name="_i3" type="str" qualifier="builtins" value="from PIL import Image%0A%0Aimg = Image.open%28%22butterfly.jpg%22%29%0Aprint%28f%22Image format%3A %7Bimg.format%7D%2C shape%7Bimg.size%7D%2C color scheme%3A %7Bimg.mode%7D%22%29%0Aimg" isIPythonHidden="True" />
<var name="_i30" type="str" qualifier="builtins" value="epochs = 25%0A%0Aloss_conv2 = nn.CrossEntropyLoss%28%29%0Aoprimizer_conv2 = torch.optim.SGD%28params=model_conv2.parameters%28%29%2C lr = 0.01%29%0A%0Aconfig = dict %28%0A    learning_rate = 0.01%2C%0A    architecture = %22CNN2%22%2C%0A    dataset_id = %22MNIST%22%2C%0A%29%0A%0Awandb.init%28%0A    project=%22Sem-02%22%2C%0A    notes=%22tweak baseline%22%2C%0A    tags=%5B%22baseline%22%5D%2C%0A    config=config%2C%0A%29%0A%0Awandb.watch%28model_conv2%29%0A%0Afor t in tqdm%28range%28epochs%29%29%3A%0A    train%28train_dataloader%2C model_conv2%2C loss_conv2%2C oprimizer_conv2%29%0A    test%28val_dataloader%2C model_conv2%2C loss_conv2%29%0A%0Aprint%28%22Done%22%29" isIPythonHidden="True" />
<var name="_i4" type="str" qualifier="builtins" value="img_matrix = np.array%28img%29%0A%0A%23 %28%D0%B2%D1%8B%D1%81%D0%BE%D1%82%D0%B0%2C %D1%88%D0%B8%D1%80%D0%B8%D0%BD%D0%B0%2C %D1%87%D0%B8%D1%81%D0%BB%D0%BE %D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%BE%D0%B2%29%0Aprint%28f%22Image matrix shape%3A %7Bimg_matrix.shape%7D%22%29%0A%0A%23 427 %D1%81%D1%82%D1%80%D0%BE%D0%BA%2C %D0%BA%D0%B0%D0%B6%D0%B4%D0%B0%D1%8F %D1%81%D1%82%D1%80%D0%BE%D0%BA%D0%B0 %D1%81%D0%BE%D0%B4%D0%B5%D1%80%D0%B6%D0%B8%D1%82 640 %D1%81%D1%82%D0%BE%D0%BB%D0%B1%D1%86%D0%BE%D0%B2%2C %D0%BA%D0%B0%D0%B6%D0%B4%D1%8B%D0%B9 %D1%8D%D0%BB%D0%B5%D0%BC%D0%B5%D0%BD%D1%82 %D1%81%D1%82%D0%BE%D0%BB%D0%B1%D1%86%D0%B0 %D0%BE%D0%BF%D0%B8%D1%81%D1%8B%D0%B2%D0%B0%D0%B5%D1%82%D1%81%D1%8F 3 %D1%87%D0%B8%D1%81%D0%BB%D0%B0%D0%BC%D0%B8 - RGB%0A%23 img_matrix%0Aplt.imshow%28img_matrix%29%0Aplt.show%28%29" isIPythonHidden="True" />
<var name="_i5" type="str" qualifier="builtins" value="%23 %D0%BF%D0%BE%D1%81%D0%BC%D0%BE%D1%82%D1%80%D0%B8%D0%BC %D0%BD%D0%B0 %D0%B2%D1%81%D0%B5 %D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D1%8B %D0%BE%D1%82%D0%B4%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%0Aplt.imshow%28img_matrix%5B%3A%2C %3A%2C 0%5D%2C cmap = cm.Reds%29%0Aplt.show%28%29%0A%0Aplt.imshow%28img_matrix%5B%3A%2C %3A%2C 1%5D%2C cmap = cm.Greens%29%0Aplt.show%28%29%0A%0Aplt.imshow%28img_matrix%5B%3A%2C %3A%2C 2%5D%2C cmap = cm.Blues%29%0Aplt.show%28%29" isIPythonHidden="True" />
<var name="_i6" type="str" qualifier="builtins" value="import torch%0Afrom torch.nn.functional import conv2d" isIPythonHidden="True" />
<var name="_i7" type="str" qualifier="builtins" value="img_tensor = torch.tensor%28%5Bimg_matrix%5D%2C dtype = torch.float%29%0A%0A%23 %28%D1%87%D0%B8%D1%81%D0%BB%D0%BE %D0%B8%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B9%2C %D0%B2%D1%8B%D1%81%D0%BE%D1%82%D0%B0%2C %D1%88%D0%B8%D1%80%D0%B8%D0%BD%D0%B0%2C %D1%87%D0%B8%D1%81%D0%BB%D0%BE %D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%BE%D0%B2%29%0Aimg_tensor.size%28%29" isIPythonHidden="True" />
<var name="_i8" type="str" qualifier="builtins" value="img_tensor = torch.permute%28img_tensor%2C %280%2C 3%2C 1%2C 2%29%29%0A%0A%23 %28%D1%87%D0%B8%D1%81%D0%BB%D0%BE %D0%B8%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B9%2C %D1%87%D0%B8%D1%81%D0%BB%D0%BE %D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%BE%D0%B2%2C %D0%B2%D1%8B%D1%81%D0%BE%D1%82%D0%B0%2C %D1%88%D0%B8%D1%80%D0%B8%D0%BD%D0%B0%29%0Aimg_tensor.size%28%29" isIPythonHidden="True" />
<var name="_i9" type="str" qualifier="builtins" value="sobel_hor = %5B%5B-1%2C -2%2C -1%5D%2C%0A             %5B 0%2C  0%2C  0%5D%2C%0A             %5B 1%2C  2%2C  1%5D%5D%0A%0A%23 %D0%BE%D0%B4%D0%BD%D0%B0 %D0%BC%D0%B0%D1%82%D1%80%D0%B8%D1%86%D0%B0 %D0%BD%D0%B0 %D0%BA%D0%B0%D0%B6%D0%B4%D1%8B%D0%B9 %D0%BA%D0%B0%D0%BD%D0%B0%D0%BB %D0%BA%D0%B0%D1%80%D1%82%D0%B8%D0%BD%D0%BA%D0%B8%0Akernel = %5B%5Bsobel_hor%2C sobel_hor%2C sobel_hor%5D%5D%0Akernel = torch.tensor%28kernel%2C dtype=torch.float%29%0A%0A%23 %28%D1%87%D0%B8%D1%81%D0%BB%D0%BE %D0%B2%D1%8B%D1%85%D0%BE%D0%B4%D0%BD%D1%8B%D1%85 %D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%BE%D0%B2%2C %D1%87%D0%B8%D1%81%D0%BB%D0%BE %D0%B2%D1%85%D0%BE%D0%B4%D0%BD%D1%8B%D1%85 %D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%BE%D0%B2%2C %D0%B2%D1%8B%D1%81%D0%BE%D1%82%D0%B0%2C %D1%88%D0%B8%D1%80%D0%B8%D0%BD%D0%B0%29%0Akernel.size%28%29" isIPythonHidden="True" />
<var name="_ih" type="list" qualifier="builtins" value="%5B%27%27%2C %27import warnings%5Cn%5Cnimport matplotlib.pyplot as plt%5Cnimport numpy as np%5Cnfrom matplotlib import cm%5Cnfrom tqdm import tqdm%5Cn%5Cnwarnings.filterwarnings%28%22ignore%22%29%27%2C %22get_ipython%28%29.system%28%27wget https%3A//raw.githubusercontent.com/hushchyn-mikhail/CourseraDL/main/cnn/screencast_1/butterfly.jpg%27%29%22%2C %27from PIL import Image%5Cn%5Cnimg = Image.open%28%22butterfly.jpg%22%29%5Cnprint%28f%22Image format%3A %7Bimg.format%7D%2C shape%7Bimg.size%7D%2C color scheme%3A %7Bimg.mode%7D%22%29%5Cnimg%27%2C %27img_matrix = np.array%28img%29%5Cn%5Cn%23 %28%D0%B2%D1%8B%D1%81%D0%BE%D1%82%D0%B0%2C %D1%88%D0%B8%D1%80%D0%B8%D0%BD%D0%B0%2C %D1%87%D0%B8%D1%81%D0%BB%D0%BE %D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%BE%D0%B2%29%5Cnprint%28f%22Image matrix shape%3A %7Bimg_matrix.shape%7D%22%29%5Cn%5Cn%23 427 %D1%81%D1%82%D1%80%D0%BE%D0%BA%2C %D0%BA%D0%B0%D0%B6%D0%B4%D0%B0%D1%8F %D1%81%D1%82%D1%80%D0%BE%D0%BA%D0%B0 %D1%81%D0%BE%D0%B4%D0%B5%D1%80%D0%B6%D0%B8%D1%82 640 %D1%81%D1%82%D0%BE%D0%BB%D0%B1%D1%86%D0%BE%D0%B2%2C %D0%BA%D0%B0%D0%B6%D0%B4%D1%8B%D0%B9 %D1%8D%D0%BB%D0%B5%D0%BC%D0%B5%D0%BD%D1%82 %D1%81%D1%82%D0%BE%D0%BB%D0%B1%D1%86%D0%B0 %D0%BE%D0%BF%D0%B8%D1%81%D1%8B%D0%B2%D0%B0%D0%B5%D1%82%D1%81%D1%8F 3 %D1%87%D0%B8%D1%81%D0%BB%D0%B0%D0%BC%D0%B8 - RGB%5Cn%23 img_matrix%5Cnplt.imshow%28img_matrix%29%5Cnplt.show%28%29%27%2C %27%23 %D0%BF%D0%BE%D1%81%D0%BC%D0%BE%D1%82%D1%80%D0%B8%D0%BC %D0%BD%D0%B0 %D0%B2%D1%81%D0%B5 %D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D1%8B %D0%BE%D1%82%D0%B4%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%5Cnplt.imshow%28img_matrix%5B%3A%2C %3A%2C 0%5D%2C cmap = cm.Reds%29%5Cnplt.show%28%29%5Cn%5Cnplt.imshow%28img_matrix%5B%3A%2C %3A%2C 1%5D%2C cmap = cm.Greens%29%5Cnplt.show%28%29%5Cn%5Cnplt.imshow%28img_matrix%5B%3A%2C %3A%2C 2%5D%2C cmap = cm.Blues%29%5Cnplt.show%28%29%27%2C %27import torch%5Cnfrom torch.nn.functional import conv2d%27%2C %27..." isContainer="True" shape="31" isIPythonHidden="True" />
<var name="_ii" type="str" qualifier="builtins" value="epochs = 25%0A%0Aconfig = dict %28%0A    learning_rate = 0.01%2C%0A    architecture = %22CNN%22%2C%0A    dataset_id = %22MNIST%22%2C%0A%29%0A%0Awandb.init%28%0A    project=%22Sem-02%22%2C%0A    notes=%22tweak baseline%22%2C%0A    tags=%5B%22baseline%22%5D%2C%0A    config=config%2C%0A%29%0A%0Awandb.watch%28model_conv%29%0A%0Afor t in tqdm%28range%28epochs%29%29%3A%0A    train%28train_dataloader%2C model_conv%2C loss_conv%2C oprimizer_conv%29%0A    test%28val_dataloader%2C model_conv%2C loss_conv%29%0A%0Aprint%28%22Done%22%29" isIPythonHidden="True" />
<var name="_iii" type="str" qualifier="builtins" value="epochs = 25%0A%0Aconfig = dict %28%0A    learning_rate = 0.01%2C%0A    architecture = %22CNN%22%2C%0A    dataset_id = %22MNIST%22%2C%0A%29%0A%0Awandb.init%28%0A    project=%22Sem-02%22%2C%0A    notes=%22tweak baseline%22%2C%0A    tags=%5B%22baseline%22%5D%2C%0A    config=config%2C%0A%29%0A%0Awandb.watch%28model_conv%29%0A%0Afor t in tqdm%28range%28epochs%29%29%3A%0A    train%28train_dataloader%2C model_conv%2C loss_conv%2C oprimizer_conv%29%0A    test%28val_dataloader%2C model%2C loss_conv%29%0A%0Aprint%28%22Done%22%29" isIPythonHidden="True" />
<var name="_oh" type="dict" qualifier="builtins" value="%7B3%3A %3CPIL.JpegImagePlugin.JpegImageFile image mode=RGB size=640x427 at 0x7F863252B0D0&gt;%2C 7%3A torch.Size%28%5B1%2C 427%2C 640%2C 3%5D%29%2C 8%3A torch.Size%28%5B1%2C 3%2C 427%2C 640%5D%29%2C 9%3A torch.Size%28%5B1%2C 3%2C 3%2C 3%5D%29%2C 10%3A torch.Size%28%5B1%2C 425%2C 638%2C 1%5D%29%2C 12%3A torch.Size%28%5B1%2C 3%2C 3%2C 3%5D%29%2C 13%3A torch.Size%28%5B1%2C 425%2C 638%2C 1%5D%29%2C 22%3A %3Cwandb.sdk.wandb_run.Run object at 0x7f852445cb20&gt;%7D" isContainer="True" shape="8" isIPythonHidden="True" />
<var name="_pydevd_bundle" type="module" qualifier="builtins" value="%3Cmodule %27_pydevd_bundle%27 from %27/snap/dataspell/15/plugins/python-ce/helpers/pydev/_pydevd_bundle/__init__.py%27&gt;" isContainer="True" />
<var name="cm" type="module" qualifier="builtins" value="%3Cmodule %27matplotlib.cm%27 from %27/home/shuffle/anaconda3/lib/python3.9/site-packages/matplotlib/cm.py%27&gt;" isContainer="True" />
<var name="config" type="dict" qualifier="builtins" value="%7B%27learning_rate%27%3A 0.01%2C %27architecture%27%3A %27CNN2%27%2C %27dataset_id%27%3A %27MNIST%27%7D" isContainer="True" shape="3" />
<var name="conv2d" type="builtin_function_or_method" qualifier="builtins" value="%3Cbuilt-in method conv2d of type object at 0x7f85c8103f80&gt;" isContainer="True" />
<var name="device" type="str" qualifier="builtins" value="cpu" />
<var name="epochs" type="int" qualifier="builtins" value="25" />
<var name="exit" type="ZMQExitAutocall" qualifier="IPython.core.autocall" value="%3CIPython.core.autocall.ZMQExitAutocall object at 0x7f8632509550&gt;" isContainer="True" isIPythonHidden="True" />
<var name="get_ipython" type="method" qualifier="builtins" value="%3Cbound method InteractiveShell.get_ipython of %3Cipykernel.zmqshell.ZMQInteractiveShell object at 0x7f86324f2880&gt;&gt;" isContainer="True" isIPythonHidden="True" />
<var name="i" type="int" qualifier="builtins" value="1" />
<var name="img" type="JpegImageFile" qualifier="PIL.JpegImagePlugin" value="%3CPIL.JpegImagePlugin.JpegImageFile image mode=RGB size=640x427 at 0x7F863252B0D0&gt;" isContainer="True" />
<var name="img_conv" type="Tensor" qualifier="torch" value="tensor%28%5B%5B%5B%5B  4.2426%5D%2C%0A          %5B 13.4164%5D%2C%0A          %5B 13.4164%5D%2C%0A          ...%2C%0A          %5B 19.0263%5D%2C%0A          %5B 33.1059%5D%2C%0A          %5B 49.4773%5D%5D%2C%0A%0A         %5B%5B 12.0830%5D%2C%0A          %5B 18.4391%5D%2C%0A          %5B 18.4391%5D%2C%0A          ...%2C%0A          %5B 28.2843%5D%2C%0A          %5B 36.7696%5D%2C%0A          %5B 49.6588%5D%5D%2C%0A%0A         %5B%5B 16.4924%5D%2C%0A          %5B 20.2485%5D%2C%0A          %5B 19.8494%5D%2C%0A          ...%2C%0A          %5B 43.2897%5D%2C%0A          %5B 48.3735%5D%2C%0A          %5B 49.4975%5D%5D%2C%0A%0A         ...%2C%0A%0A         %5B%5B 60.1664%5D%2C%0A          %5B133.8805%5D%2C%0A          %5B180.3607%5D%2C%0A          ...%2C%0A          %5B101.0445%5D%2C%0A          %5B 61.2699%5D%2C%0A          %5B 27.8568%5D%5D%2C%0A%0A         %5B%5B  1.4142%5D%2C%0A          %5B182.7019%5D%2C%0A          %5B256.3201%5D%2C%0A          ...%2C%0A          %5B  2.8284%5D%2C%0A          %5B 90.4434%5D%2C%0A          %5B 49.8197%5D%5D%2C%0A%0A         %5B%5B 46.6690%5D%2C%0A          %5B117.3882%5D%2C%0A          %5B474.0907%5D%2C%0A          ...%2C%0A          %5B 87.7838%5D%2C%0A          %5B118.1186%5D%2C%0A          %5B 89.4986%5D%5D%5D%5D%29" isContainer="True" shape="(1, 425, 638, 1)" />
<var name="img_conv_hor" type="Tensor" qualifier="torch" value="tensor%28%5B%5B%5B%5B -3.%5D%2C%0A          %5B -6.%5D%2C%0A          %5B -6.%5D%2C%0A          ...%2C%0A          %5B-19.%5D%2C%0A          %5B-14.%5D%2C%0A          %5B-12.%5D%5D%2C%0A%0A         %5B%5B -5.%5D%2C%0A          %5B-12.%5D%2C%0A          %5B-14.%5D%2C%0A          ...%2C%0A          %5B-28.%5D%2C%0A          %5B-26.%5D%2C%0A          %5B-21.%5D%5D%2C%0A%0A         %5B%5B -4.%5D%2C%0A          %5B -7.%5D%2C%0A          %5B-13.%5D%2C%0A          ...%2C%0A          %5B-43.%5D%2C%0A          %5B-42.%5D%2C%0A          %5B-35.%5D%5D%2C%0A%0A         ...%2C%0A%0A         %5B%5B 56.%5D%2C%0A          %5B-32.%5D%2C%0A          %5B-63.%5D%2C%0A          ...%2C%0A          %5B 63.%5D%2C%0A          %5B 55.%5D%2C%0A          %5B 10.%5D%5D%2C%0A%0A         %5B%5B  1.%5D%2C%0A          %5B 16.%5D%2C%0A          %5B 72.%5D%2C%0A          ...%2C%0A          %5B -2.%5D%2C%0A          %5B 28.%5D%2C%0A          %5B -9.%5D%5D%2C%0A%0A         %5B%5B-33.%5D%2C%0A          %5B 84.%5D%2C%0A          %5B271.%5D%2C%0A          ...%2C%0A          %5B-65.%5D%2C%0A          %5B-56.%5D%2C%0A          %5B-57.%5D%5D%5D%5D%29" isContainer="True" shape="(1, 425, 638, 1)" />
<var name="img_conv_ver" type="Tensor" qualifier="torch" value="tensor%28%5B%5B%5B%5B1181.5408%5D%2C%0A          %5B1176.8838%5D%2C%0A          %5B1173.3685%5D%2C%0A          ...%2C%0A          %5B1169.9305%5D%2C%0A          %5B1159.1927%5D%2C%0A          %5B1145.2980%5D%5D%2C%0A%0A         %5B%5B1179.5864%5D%2C%0A          %5B1175.7477%5D%2C%0A          %5B1170.0970%5D%2C%0A          ...%2C%0A          %5B1161.7052%5D%2C%0A          %5B1152.5010%5D%2C%0A          %5B1138.6024%5D%5D%2C%0A%0A         %5B%5B1175.2430%5D%2C%0A          %5B1171.7261%5D%2C%0A          %5B1163.6361%5D%2C%0A          ...%2C%0A          %5B1148.2705%5D%2C%0A          %5B1142.7534%5D%2C%0A          %5B1128.1183%5D%5D%2C%0A%0A         ...%2C%0A%0A         %5B%5B1569.6132%5D%2C%0A          %5B1573.4064%5D%2C%0A          %5B1593.9332%5D%2C%0A          ...%2C%0A          %5B1037.4331%5D%2C%0A          %5B1049.9446%5D%2C%0A          %5B1019.9528%5D%5D%2C%0A%0A         %5B%5B1578.8855%5D%2C%0A          %5B1551.5087%5D%2C%0A          %5B1604.6646%5D%2C%0A          ...%2C%0A          %5B1056.4213%5D%2C%0A          %5B1048.6746%5D%2C%0A          %5B1025.0972%5D%5D%2C%0A%0A         %5B%5B1577.3755%5D%2C%0A          %5B1548.3295%5D%2C%0A          %5B1638.9458%5D%2C%0A          ...%2C%0A          %5B1062.7125%5D%2C%0A          %5B1048.2697%5D%2C%0A          %5B1026.1779%5D%5D%5D%5D%29" isContainer="True" shape="(1, 425, 638, 1)" />
<var name="img_matrix" type="ndarray" qualifier="numpy" value="%5B%5B%5B101 153 107%5D%2C  %5B101 153 107%5D%2C  %5B101 153 107%5D%2C  ...%2C  %5B114 146  99%5D%2C  %5B112 144  97%5D%2C  %5B110 142  95%5D%5D%2C%2C %5B%5B101 153 107%5D%2C  %5B101 153 107%5D%2C  %5B101 153 107%5D%2C  ...%2C  %5B114 146  99%5D%2C  %5B111 143  96%5D%2C  %5B110 142  95%5D%5D%2C%2C %5B%5B101 153 107%5D%2C  %5B101 153 107%5D%2C  %5B100 152 106%5D%2C  ...%2C  %5B113 145  98%5D%2C  %5B111 143  96%5D%2C  %5B109 141  94%5D%5D%2C%2C ...%2C%2C %5B%5B133 163 153%5D%2C  %5B131 161 153%5D%2C  %5B126 156 148%5D%2C  ...%2C  %5B 73 117  58%5D%2C  %5B 74 118  59%5D%2C  %5B 75 119  60%5D%5D%2C%2C %5B%5B134 161 154%5D%2C  %5B132 159 152%5D%2C  %5B127 154 147%5D%2C  ...%2C  %5B 71 115  56%5D%2C  %5B 72 116  57%5D%2C  %5B 73 117  58%5D%5D%2C%2C %5B%5B136 163 158%5D%2C  %5B135 162 157%5D%2C  %5B134 159 155%5D%2C  ...%2C  %5B 70 113  57%5D%2C  %5B 70 114  55%5D%2C  %5B 71 115  56%5D%5D%5D" isContainer="True" shape="(427, 640, 3)" />
<var name="img_tensor" type="Tensor" qualifier="torch" value="tensor%28%5B%5B%5B%5B101.%2C 101.%2C 101.%2C  ...%2C 114.%2C 112.%2C 110.%5D%2C%0A          %5B101.%2C 101.%2C 101.%2C  ...%2C 114.%2C 111.%2C 110.%5D%2C%0A          %5B101.%2C 101.%2C 100.%2C  ...%2C 113.%2C 111.%2C 109.%5D%2C%0A          ...%2C%0A          %5B135.%2C 144.%2C 132.%2C  ...%2C 102.%2C  97.%2C  99.%5D%2C%0A          %5B133.%2C 142.%2C 137.%2C  ...%2C 100.%2C  94.%2C  97.%5D%2C%0A          %5B132.%2C 139.%2C 138.%2C  ...%2C  98.%2C  92.%2C  93.%5D%5D%2C%0A%0A         %5B%5B153.%2C 153.%2C 153.%2C  ...%2C 146.%2C 144.%2C 142.%5D%2C%0A          %5B153.%2C 153.%2C 153.%2C  ...%2C 146.%2C 143.%2C 142.%5D%2C%0A          %5B153.%2C 153.%2C 152.%2C  ...%2C 145.%2C 143.%2C 141.%5D%2C%0A          ...%2C%0A          %5B167.%2C 179.%2C 169.%2C  ...%2C 168.%2C 162.%2C 164.%5D%2C%0A          %5B165.%2C 177.%2C 173.%2C  ...%2C 166.%2C 160.%2C 162.%5D%2C%0A          %5B164.%2C 174.%2C 174.%2C  ...%2C 164.%2C 159.%2C 160.%5D%5D%2C%0A%0A         %5B%5B107.%2C 107.%2C 107.%2C  ...%2C  99.%2C  97.%2C  95.%5D%2C%0A          %5B107.%2C 107.%2C 107.%2C  ...%2C  99.%2C  96.%2C  95.%5D%2C%0A          %5B107.%2C 107.%2C 106.%2C  ...%2C  98.%2C  96.%2C  94.%5D%2C%0A          ...%2C%0A          %5B166.%2C 175.%2C 161.%2C  ...%2C  70.%2C  62.%2C  62.%5D%2C%0A          %5B164.%2C 171.%2C 163.%2C  ...%2C  68.%2C  60.%2C  58.%5D%2C%0A          %5B161.%2C 168.%2C 162.%2C  ......" isContainer="True" shape="(1, 3, 427, 640)" />
<var name="kernel" type="Tensor" qualifier="torch" value="tensor%28%5B%5B%5B%5B0.3338%2C 0.4883%2C 0.9932%5D%2C%0A          %5B0.1978%2C 0.5152%2C 0.0670%5D%2C%0A          %5B0.2392%2C 0.2918%2C 0.0030%5D%5D%2C%0A%0A         %5B%5B0.1312%2C 0.3256%2C 0.6593%5D%2C%0A          %5B0.1507%2C 0.0907%2C 0.9304%5D%2C%0A          %5B0.5503%2C 0.0546%2C 0.0138%5D%5D%2C%0A%0A         %5B%5B0.6788%2C 0.7988%2C 0.6044%5D%2C%0A          %5B0.3040%2C 0.2679%2C 0.9357%5D%2C%0A          %5B0.2118%2C 0.1205%2C 0.0106%5D%5D%5D%5D%29" isContainer="True" shape="(1, 3, 3, 3)" />
<var name="loss" type="CrossEntropyLoss" qualifier="torch.nn.modules.loss" value="CrossEntropyLoss%28%29" isContainer="True" />
<var name="loss_conv" type="CrossEntropyLoss" qualifier="torch.nn.modules.loss" value="CrossEntropyLoss%28%29" isContainer="True" />
<var name="loss_conv2" type="CrossEntropyLoss" qualifier="torch.nn.modules.loss" value="CrossEntropyLoss%28%29" isContainer="True" />
<var name="mnist_train" type="MNIST" qualifier="torchvision.datasets.mnist" value="Dataset MNIST%0A    Number of datapoints%3A 60000%0A    Root location%3A ./mnist-data/%0A    Split%3A Train%0A    StandardTransform%0ATransform%3A Compose%28%0A               ToTensor%28%29%0A               Normalize%28mean=%280.1307%2C%29%2C std=%280.3081%2C%29%29%0A           %29" isContainer="True" shape="60000" />
<var name="mnist_val" type="MNIST" qualifier="torchvision.datasets.mnist" value="Dataset MNIST%0A    Number of datapoints%3A 10000%0A    Root location%3A ./mnist-data/%0A    Split%3A Test%0A    StandardTransform%0ATransform%3A Compose%28%0A               ToTensor%28%29%0A               Normalize%28mean=%280.1307%2C%29%2C std=%280.3081%2C%29%29%0A           %29" isContainer="True" shape="10000" />
<var name="model" type="NeuralNetwork" qualifier="__main__" value="NeuralNetwork%28%0A  %28Flatten%29%3A Flatten%28start_dim=1%2C end_dim=-1%29%0A  %28linear_relu_stack%29%3A Sequential%28%0A    %280%29%3A Linear%28in_features=784%2C out_features=128%2C bias=True%29%0A    %281%29%3A ReLU%28%29%0A    %282%29%3A Linear%28in_features=128%2C out_features=10%2C bias=True%29%0A  %29%0A%29" isContainer="True" />
<var name="model_conv" type="ConvNeuralNetwork" qualifier="__main__" value="ConvNeuralNetwork%28%0A  %28conv_linear_relu_stack%29%3A Sequential%28%0A    %280%29%3A Conv2d%281%2C 10%2C kernel_size=%285%2C 5%29%2C stride=%281%2C 1%29%29%0A    %281%29%3A ReLU%28%29%0A    %282%29%3A MaxPool2d%28kernel_size=4%2C stride=4%2C padding=0%2C dilation=1%2C ceil_mode=False%29%0A    %283%29%3A Flatten%28start_dim=1%2C end_dim=-1%29%0A    %284%29%3A Linear%28in_features=360%2C out_features=128%2C bias=True%29%0A    %285%29%3A ReLU%28%29%0A    %286%29%3A Linear%28in_features=128%2C out_features=10%2C bias=True%29%0A  %29%0A%29" isContainer="True" />
<var name="model_conv2" type="Conv2NeuralNetwork" qualifier="__main__" value="Conv2NeuralNetwork%28%0A  %28conv_pooling_linear_relu_stack%29%3A Sequential%28%0A    %280%29%3A Conv2d%281%2C 10%2C kernel_size=%285%2C 5%29%2C stride=%281%2C 1%29%29%0A    %281%29%3A ReLU%28%29%0A    %282%29%3A MaxPool2d%28kernel_size=2%2C stride=2%2C padding=0%2C dilation=1%2C ceil_mode=False%29%0A    %283%29%3A Conv2d%2810%2C 20%2C kernel_size=%285%2C 5%29%2C stride=%281%2C 1%29%29%0A    %284%29%3A ReLU%28%29%0A    %285%29%3A MaxPool2d%28kernel_size=2%2C stride=2%2C padding=0%2C dilation=1%2C ceil_mode=False%29%0A    %286%29%3A Flatten%28start_dim=1%2C end_dim=-1%29%0A    %287%29%3A Linear%28in_features=320%2C out_features=128%2C bias=True%29%0A    %288%29%3A ReLU%28%29%0A    %289%29%3A Linear%28in_features=128%2C out_features=10%2C bias=True%29%0A  %29%0A%29" isContainer="True" />
<var name="nn" type="module" qualifier="builtins" value="%3Cmodule %27torch.nn%27 from %27/home/shuffle/anaconda3/lib/python3.9/site-packages/torch/nn/__init__.py%27&gt;" isContainer="True" />
<var name="np" type="module" qualifier="builtins" value="%3Cmodule %27numpy%27 from %27/home/shuffle/anaconda3/lib/python3.9/site-packages/numpy/__init__.py%27&gt;" isContainer="True" />
<var name="oprimizer" type="SGD" qualifier="torch.optim.sgd" value="SGD %28%0AParameter Group 0%0A    dampening%3A 0%0A    lr%3A 0.01%0A    maximize%3A False%0A    momentum%3A 0%0A    nesterov%3A False%0A    weight_decay%3A 0%0A%29" isContainer="True" />
<var name="oprimizer_conv" type="SGD" qualifier="torch.optim.sgd" value="SGD %28%0AParameter Group 0%0A    dampening%3A 0%0A    lr%3A 0.01%0A    maximize%3A False%0A    momentum%3A 0%0A    nesterov%3A False%0A    weight_decay%3A 0%0A%29" isContainer="True" />
<var name="oprimizer_conv2" type="SGD" qualifier="torch.optim.sgd" value="SGD %28%0AParameter Group 0%0A    dampening%3A 0%0A    lr%3A 0.01%0A    maximize%3A False%0A    momentum%3A 0%0A    nesterov%3A False%0A    weight_decay%3A 0%0A%29" isContainer="True" />
<var name="plt" type="module" qualifier="builtins" value="%3Cmodule %27matplotlib.pyplot%27 from %27/home/shuffle/anaconda3/lib/python3.9/site-packages/matplotlib/pyplot.py%27&gt;" isContainer="True" />
<var name="pydev_jupyter_vars" type="module" qualifier="builtins" value="%3Cmodule %27pydev_jupyter_vars%27 from %27/snap/dataspell/15/plugins/python-ce/helpers-pro/jupyter_debug/pydev_jupyter_vars.py%27&gt;" isContainer="True" />
<var name="quit" type="ZMQExitAutocall" qualifier="IPython.core.autocall" value="%3CIPython.core.autocall.ZMQExitAutocall object at 0x7f8632509550&gt;" isContainer="True" isIPythonHidden="True" />
<var name="remove_imported_pydev_package" type="function" qualifier="builtins" value="%3Cfunction remove_imported_pydev_package at 0x7f84eb636ca0&gt;" isContainer="True" />
<var name="sobel_hor" type="list" qualifier="builtins" value="%5B%5B-1%2C -2%2C -1%5D%2C %5B0%2C 0%2C 0%5D%2C %5B1%2C 2%2C 1%5D%5D" isContainer="True" shape="3" />
<var name="sobel_ver" type="list" qualifier="builtins" value="%5B%5B-1%2C 0%2C 1%5D%2C %5B-2%2C 0%2C 2%5D%2C %5B-1%2C 0%2C 1%5D%5D" isContainer="True" shape="3" />
<var name="sys" type="module" qualifier="builtins" value="%3Cmodule %27sys%27 %28built-in%29&gt;" isContainer="True" />
<var name="t" type="int" qualifier="builtins" value="24" />
<var name="test" type="function" qualifier="builtins" value="%3Cfunction test at 0x7f8524443e50&gt;" isContainer="True" />
<var name="torch" type="module" qualifier="builtins" value="%3Cmodule %27torch%27 from %27/home/shuffle/anaconda3/lib/python3.9/site-packages/torch/__init__.py%27&gt;" isContainer="True" />
<var name="torchvision" type="module" qualifier="builtins" value="%3Cmodule %27torchvision%27 from %27/home/shuffle/anaconda3/lib/python3.9/site-packages/torchvision/__init__.py%27&gt;" isContainer="True" />
<var name="tqdm" type="type" qualifier="builtins" value="%3Cclass %27tqdm.std.tqdm%27&gt;" isContainer="True" />
<var name="train" type="function" qualifier="builtins" value="%3Cfunction train at 0x7f8524443b80&gt;" isContainer="True" />
<var name="train_dataloader" type="DataLoader" qualifier="torch.utils.data.dataloader" value="%3Ctorch.utils.data.dataloader.DataLoader object at 0x7f8528270eb0&gt;" isContainer="True" shape="938" />
<var name="transform" type="Compose" qualifier="torchvision.transforms.transforms" value="Compose%28%0A    ToTensor%28%29%0A    Normalize%28mean=%280.1307%2C%29%2C std=%280.3081%2C%29%29%0A%29" isContainer="True" />
<var name="val_dataloader" type="DataLoader" qualifier="torch.utils.data.dataloader" value="%3Ctorch.utils.data.dataloader.DataLoader object at 0x7f8528270fd0&gt;" isContainer="True" shape="157" />
<var name="wandb" type="module" qualifier="builtins" value="%3Cmodule %27wandb%27 from %27/home/shuffle/anaconda3/lib/python3.9/site-packages/wandb/__init__.py%27&gt;" isContainer="True" />
<var name="warnings" type="module" qualifier="builtins" value="%3Cmodule %27warnings%27 from %27/home/shuffle/anaconda3/lib/python3.9/warnings.py%27&gt;" isContainer="True" />

100%|██████████| 25/25 [21:34<00:00, 51.78s/it]